FROM node:14

# Create a non-root user and switch to that user
RUN adduser --disabled-password --gecos '' appuser
USER appuser

WORKDIR /usr/src/app

COPY package*.json ./

# Install npm dependencies globally
RUN npm install -g @angular/cli

# Install project dependencies
RUN npm install

COPY . .

RUN ng build

EXPOSE 80

CMD ["npm", "start"]
