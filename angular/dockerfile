FROM node:14

# Create a non-root user and switch to that user
USER root

WORKDIR /usr/src/app

COPY package*.json ./

# Set npm prefix to user directory
RUN npm config set prefix ~/.npm

# Install global npm packages in user directory
RUN npm install -g @angular/cli

# Install project dependencies
RUN npm install

COPY . .

RUN ng build

EXPOSE 80

CMD ["npm", "start"]

